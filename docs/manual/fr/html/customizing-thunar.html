<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>Personnaliser Thunar</title><link rel="stylesheet" href="../thunar.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.73.2"><link rel="start" href="index.html" title="Gestionnaire de fichiers Thunar"><link rel="up" href="index.html" title="Gestionnaire de fichiers Thunar"><link rel="prev" href="preferences.html" title="Préférences du gestionnaire de fichiers"><link rel="next" href="advanced-topics.html" title="Sujets avancés"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Personnaliser Thunar</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="preferences.html">Précédent</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="advanced-topics.html">Suivant</a></td></tr></table><hr></div><div class="sect1" lang="fr"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="customizing-thunar"></a>Personnaliser Thunar</h2></div></div></div><p>Cette section décrit comment vous pouvez personnaliser certaines parties du gestionnaire de fichiers.</p><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="sendto"></a>Le menu "Envoyer vers"</h3></div></div></div><p>Thunar inclut un menu <span class="guilabel"><strong>Envoyer vers</strong></span> qui permet d'envoyer certains fichiers ou dossiers vers une destination prédéfinie. Pour accéder au menu <span class="guilabel"><strong>Envoyer vers</strong></span>, choisissez <span class="guimenu"><strong>Fichier</strong></span> &#8594; <span class="guimenuitem"><strong>Envoyer vers</strong></span> dans le menu principal ou cliquez-droit sur un fichier ou dossier et choisissez <span class="guimenuitem"><strong>Envoyer vers</strong></span>.</p><div class="screenshot"><div class="mediaobject"><img src="images/sendto-menu.png" alt='Menu "Envoyer vers"'></div></div><p>Par défaut le menu <span class="guilabel"><strong>Envoyer  vers</strong></span> contient un élément <span class="guilabel"><strong>Bureau (Créer lien)</strong></span> pour tous les fichiers et dossiers. Cet élément crée un lien sur le bureau vers le fichier ou dossier sélectionné. Si le <span class="guilabel"><strong>Panneau des raccourcis</strong></span> est actif, vous trouverez aussi dans le menu un élément <span class="guilabel"><strong>Panneau latéral (Créer raccourci)</strong></span> pour les dossiers, ce qui vous permets de créer de nouveaux raccourcis dans le panneau latéral. À la suite de ces éléments du menu <span class="guilabel"><strong>Envoyer  vers</strong></span>, Thunar vient ajouter à la liste les disques amovibles actuellement branchés à l'ordinateur. Dans la capture d'écran ci-dessus, le <span class="guilabel"><strong>Lecteur de disquettes</strong></span> représente une destination possible pour l'envoi de fichiers. Le disque est "monté" (mount) automatiquement à la sélection dans le menu <span class="guilabel"><strong>Envoyer  vers</strong></span> pour que vous n'ayez pas besoin de le faire vous-même.</p><p><strong class="application"><code>Thunar</code></strong> contient d'office un greffon <strong class="application"><code>thunar-sendto-email</code></strong> qui ajoute l'élément <span class="guilabel"><strong>Destinataire courriel</strong></span> au menu. Ce dernier permet d'envoyer les fichiers ou dossiers sélectionnés, avec le programme de messagerie par défaut. Si la sélection contient au moins un dossier, le tout est ajouté dans une archive ZIP avant d'être attaché au courriel. Le gestionnaire de fichiers demandera à l'utilisateur s'il faut compresser les fichiers avant de les envoyer, dans le cas de fichiers multiples ou dépassant 200Ko.</p><p>Comme la plupart des particularités de <strong class="application"><code>Thunar</code></strong>, le menu <span class="guilabel"><strong>Envoyer  vers</strong></span> peut aisément être personnalisé avec de nouveaux éléments par l'utilisateur ou les développeurs d'applications en utilisant des fichiers standards <a class="ulink" href="http://freedesktop.org/wiki/Standards_2fdesktop_2dentry_2dspec" target="_top">desktop entry files</a>. Ces fichiers doivent êtres installés dans un des dossiers <code class="filename">$XDG_DATA_DIRS/Thunar/sendto/</code> (suivez le lien <a class="ulink" href="http://freedesktop.org/wiki/Standards_2fbasedir_2dspec" target="_top">XDG Base Directory Specification</a> pour plus de détails à propos de la variable <code class="literal">$XDG_DATA_DIRS</code>).</p><p>Le <code class="literal">MimeType</code> de la destination <code class="filename">.desktop</code> spécifie le type de fichiers pour lesquels cette action doit apparaître dans le menu <span class="guilabel"><strong>Envoyer  vers</strong></span>. Par exemple, imaginons un instant que vous vouliez ajouter un élément permettant de télécharger (upload) vers le site <a class="ulink" href="http://flickr.com/" target="_top">Flickr</a>, cet élément ne devrait s'afficher que pour les images au format JPEG (d'autres formats ne sont pas supportés par flickr). Vous devriez donc ajouter la ligne <code class="literal">MimeType=image/jpeg;</code> dans les types de votre élément. Si vous ne spécifiez pas de <code class="literal">MimeType</code>, votre élément s'affichera pour tous les fichiers.</p><p>Ci-dessous se trouve un exemple complet utilisant l'application <strong class="application"><code>postr</code></strong> :</p><pre class="programlisting">
# postr.desktop - Intégrer postr dans
#                 le menu "Envoyer vers".
[Desktop Entry]
Type=Application
Version=1.0
Encoding=UTF-8
TryExec=postr
Exec=postr %F
Icon=postr
Name=Flickr
MimeType=image/jpeg;</pre><p>Si vous installez ce fichier dans <code class="filename">~/.local/share/Thunar/sendto/</code> (créez le dossier s'il n'existe pas encore), le menu <span class="guilabel"><strong>Envoyer  vers</strong></span> comprendra le nouvel élément <span class="guilabel"><strong>Flickr</strong></span> pour tous les fichiers JPEG et pourra être utilisé pour envoyer des images sur le site Flickr.</p><p>Le site <a class="ulink" href="http://thunar.xfce.org/pwiki/documentation/sendto_menu" target="_top">Thunar Project Wiki</a> contient d'autres exemples d'éléments utiles pour le menu <span class="guilabel"><strong>Envoyer  vers</strong></span>. N'hésitez pas à compléter le wiki avec vos suggestions.</p></div><div class="sect2" lang="fr"><div class="titlepage"><div><div><h3 class="title"><a name="thumbnailers"></a>Thumbnailers (Créateurs de miniatures)</h3></div></div></div><p>Thunar utilise de petits utilitaires pour créer les miniatures de certains types de fichiers et affiche ces miniatures comme pré-visualisation du contenu dudit fichier. Ces petits utilitaires sont appelés des "thumbnailers". Thunar vient d'office avec plusieurs créateurs de miniatures installés et fait usage des facilités de créations de miniatures offertes par GNOME s'il a été installé avec le support <code class="literal">gconf</code>. L'utilisateur peut néanmoins ajouter à ces fonctions de base, tout créateur de miniatures additionnel pour différents types de fichiers.</p><p>Si vous envisagez d'écrire un créateur de miniatures personnalisé, vous devez vous assurer que votre programme supporte au moins deux lignes de commande, le fichier d'entrée, qui serait votre type de fichier à ajouter et le fichier de sortie, qui doit être au format PNG et conforme aux spécifications du <a class="ulink" href="http://jens.triq.net/thumbnail-spec/creation.html#AEN139" target="_top">Thumbnail Management Standard</a>. En plus, votre programme pourrait accepter les tailles définies de miniatures, ce qui est optionnel mais fortement recommandé. Si vous optez pour ne pas suivre la taille définie de miniature, Thunar viendrait à redimensionner l'image pour lui donner la taille standard et le résultat pourrait être inférieur en qualité qu'un dimensionnement juste dès le départ.</p><p>Une fois votre utilitaire terminé, vous devrez l'enregistrer auprès de Thunar pour qu'il puisse en faire usage. Pour cela il vous suffit d'installer un fichier de description pour votre créateur de miniatures (un fichier <code class="filename">.desktop</code>) dans un des dossiers <code class="filename">$XDG_DATA_DIRS/thumbnailers/</code>. Par exemple, si vous voulez utiliser le créateur de miniatures uniquement pour votre utilisateur, vous installerez le fichier de description dans le dossier <code class="filename">~/.local/share/thumbnailers/</code>. Le fichier <code class="filename">.desktop</code> pour le créations de miniatures a le format suivant.</p><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="thumbnailer-desktop-file-format"></a>Fichier de description de création de miniatures</h4></div></div></div><p>Les fichiers de description de créateurs de miniatures utilisent le format <a class="ulink" href="http://standards.freedesktop.org/desktop-entry-spec/latest/" target="_top">Desktop Entry Format</a> avec un <code class="literal">Type</code> spécial <code class="literal">X-Thumbnailer</code> et de nouveaux codes dans le champ <code class="literal">X-Thumbnailer-Exec</code>. D'une certaine manière, un fichier de description d'un créateur de miniatures a le format suivant :</p><pre class="programlisting">
[Desktop Entry]
Version=1.0
Encoding=UTF-8
Type=X-Thumbnailer
Name=Your Thumbnailer
MimeType=your-supported/mime-type;
X-Thumbnailer-Exec=votre-créateur-de-miniatures %i %o %s</pre><p>Les champs <code class="literal">Version</code> et <code class="literal">Encoding</code> sont ordonnés par le "Desktop Entry Specification", utilisez les valeurs utilisées dans l'exemple ci-dessus. Le champ <code class="literal">Type</code> doit impérativement contenir la valeur <code class="literal">X-Thumbnailer</code> faute de quoi le créateur de miniatures ne serait pas reconnu. Le champ <code class="literal">Name</code> décrit votre créateur de miniatures.</p><p>Le champ <code class="literal">X-Thumbnailer-Exec</code> contient la commande à exécuter pour le créateur de miniatures et supporte certains codes qui se substitueront à l'exécution. Les codes reconnus sont les suivants :</p><div class="variablelist"><dl><dt><span class="term"><code class="varname">%i</code></span></dt><dd>Le chemin d'accès jusqu'au fichier pour lequel il faut créer une miniature. Peut être un chemin d'accès partant du dossier d'où est exécuté le créateur de miniatures ou un chemin d'accès complet.</dd><dt><span class="term"><code class="varname">%o</code></span></dt><dd>Le chemin d'accès jusqu'au fichier de sortie contenant la miniature générée. Le fichier de sortie doit être au format PNG en concordance avec le standard de miniatures (voir plus haut). Le fichier ne doit pas obligatoirement se terminer par <code class="literal">.png</code>, surtout si vous utilisez une tierce application.</dd><dt><span class="term"><code class="varname">%s</code></span></dt><dd>La taille voulue de la miniature en pixels. Ce paramètre est optionnel.</dd><dt><span class="term"><code class="varname">%u</code></span></dt><dd>Similaire à <code class="literal">%i</code> mais substitué à l'URI du fichier plutôt qu'à son chemin d'accès. Ceci a été ajouté pour la compatibilité avec GNOME.</dd><dt><span class="term"><code class="varname">%%</code></span></dt><dd>Se substitue par un simple <code class="literal">%</code>.</dd></dl></div><p>Vous devez au moins inclure <code class="literal">%o</code> et <code class="literal">%i</code> ou <code class="literal">%u</code>, sinon votre créateur de miniatures sera inutile.</p><p>Le champ  <code class="literal">MimeType</code> liste les types MIME - séparés par un point-virgule - pour lesquels votre créateur de miniatures est capable de créer des miniatures.</p></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="eps-thumbnailer-example"></a>Exemple d'un créateur de miniatures pour EPS</h4></div></div></div><p>Cet exemple démontre comment écrire et installer un nouveau créateur de miniatures pour les fichiers de type <code class="filename">.eps</code> qui utilise la commande <span class="command"><strong>convert</strong></span> de la suite ImageMagick. Nous commençons par invoquer la commande <span class="command"><strong>convert</strong></span> pour générer une miniature à la taille voulue.</p><pre class="programlisting">
#!/bin/sh
#
# eps-thumbnailer - Exemple de script pour la création de miniatures pour les fichiers EPS.
#
# Utilisation: esp-thumbnailer fichier-eps fichier-png taille
#

# paramètres de la ligne de commande
ifile=$1
ofile=$2
size=$3

# invoke convert (ImageMagick)
exec convert "eps:$ifile" -scale "$sizex$size" "png:$ofile"</pre><p>Enregistrez le script ci-dessus dans un fichier <code class="filename">eps-thumbnailer</code>, assurez-vous qu'il soit bien exécutable et installez le dans <code class="filename">/usr/local/bin</code>.</p><pre class="screen">
$ chmod +x eps-thumbnailer
$ sudo install eps-thumbnailer /usr/local/bin/eps-thumbnailer</pre><p>Ensuite nous allons créer le fichier de description <code class="filename">eps-thumbnailer.desktop</code> qui ressemble à cela :</p><pre class="programlisting">
[Desktop Entry]
Version=1.0
Encoding=UTF-8
Type=X-Thumbnailer
Name=EPS Thumbnailer
TryExec=convert
MimeType=image/x-eps;
X-Thumbnailer-Exec=/usr/local/bin/eps-thumbnailer %i %o %s</pre><p>Ce fichier doit être installé dans le dossier <code class="filename">/usr/local/share/thumbnailers</code> (créez le s'il n'existe pas).</p><pre class="screen">
$ sudo install -d /usr/local/share/thumbnailers
$ sudo install eps-thumbnailer.desktop /usr/local/share/thumbnailers/eps-thumbnailer.desktop</pre><p>Le fichier du créateur de miniatures <code class="filename">eps-thumbnailer.desktop</code> utilise la commande spéciale <code class="literal">TryExec</code>, qui, si elle est spécifiée, nomme une commande qui doit être présente dans le système pour que le créateur de miniatures soit utile. Le script serait inutile si la commande <span class="command"><strong>convert</strong></span> n'était pas disponible.</p><p>La dernière étape est celle de régénérer le cache de créateurs de miniatures pour que Thunar soit au courant que nous lui en avons ajouté un. Le cache se situe dans <code class="filename">$XDG_CACHE_HOME/Thunar/thumbnailers.cache</code> (à moins que vous ou votre administrateur système n'ayez changé l'emplacement, <code class="varname">$XDG_CACHE_HOME</code> devrait se trouver dans <code class="filename">~/.cache/</code>). Le cache des créateurs de miniatures est automatiquement régénéré périodiquement par Thunar mais vous pouvez forcer ce rafraîchissement en invoquant la commande <code class="filename">thunar-vfs-update-thumbnailers-cache-1</code>. Cet utilitaire est installé, la plupart du temps, dans le sous-dossier <code class="filename">libexec</code> de votre préfixe d'installation (<code class="filename">sbin</code> dans Debian/Ubuntu). Donc, par exemple, si Thunar est installé dans <code class="filename">/usr</code>, la commande serait la suivante :</p><pre class="screen">$ /usr/libexec/thunar-vfs-update-thumbnailers-cache-1</pre><p>Mais soyez certain de bien exécuter la commande depuis votre compte d'utilisateur et non celui du super-utilisateur (root), car votre cache de miniatures se trouve dans votre dossier personnel et non dans un emplacement pour tout le système.</p><p>Maintenant, si Thunar a été compilé avec le support un moniteur de modifications tel que FAM ou GAMIN, il va automatiquement prendre en compte le nouveau créateur de miniatures dans les secondes qui suivent et sera capable de créer des miniatures grâce à lui. Sinon il faudra redémarrer Thunar pour appliquer les changements en utilisant la commande :</p><pre class="screen">$ Thunar -q</pre><p>pour arrêter toute instance de Thunar et le relancer par la suite depuis son lanceur.</p></div><div class="sect3" lang="fr"><div class="titlepage"><div><div><h4 class="title"><a name="cleaning-up-thumbnails"></a>Purger les miniatures</h4></div></div></div><p>Les miniatures créés sont stockés dans le dossier <code class="filename">~/.thumbnails/</code> en concordance avec la norme <a class="ulink" href="http://jens.triq.net/thumbnail-spec/index.html" target="_top">Thumbnail Management Standard</a>. Lorsque vous testez un nouveau créateur de miniatures, il peut être préférable de d'abord purger les miniatures avec la commande suivante :</p><pre class="screen">$ rm -rf ~/.thumbnails/</pre><p>ce qui vous libérera aussi un peu d'espace dans votre dossier personnel. Les miniatures étant créées à partir de fichiers de votre système, vous ne perdrez pas de données en le vidant.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="preferences.html">Précédent</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="advanced-topics.html">Suivant</a></td></tr><tr><td width="40%" align="left" valign="top">Préférences du gestionnaire de fichiers </td><td width="20%" align="center"><a accesskey="h" href="index.html">Sommaire</a></td><td width="40%" align="right" valign="top"> Sujets avancés</td></tr></table></div></body></html>
